<?xml version='1.0' encoding='UTF-8'?>
<!-- This document was created with Syntext Serna Free. --><chapter lang="ru" id="chapter2_working_in_nix">
  <title>Установка и настройка OpenOffice.org</title>
  <para>Подсистема отчетов использует <application>OpenOffice</application> для создания doc и pdf отчетов. Для работы в серверном режиме необходима установка <application>OpenOffice</application>. Установка и настройка <application>OpenOffice</application> различается в системах <application>Microsoft Windows</application> и в системах  класса <application>UNIX</application>.</para>
  <para><emphasis role="bold">Установка и настройка OpenOffice.org в системах Microsoft Windows</emphasis></para>
  <itemizedlist>
    <listitem>
      <para>Скачайте дистрибутив программы по ссылке <ulink url="http://openoffice.org/">http://openoffice.org/</ulink>.</para>
    </listitem>
    <listitem>
      <para>Произведите установку программы.</para>
    </listitem>
    <listitem>
      <para>Установите свойство в файле <filename>local.app.properties</filename></para>
      <para><property>cuba.reporting.openoffice.path</property> = <literal>C:/Program Files (x86)/OpenOffice.org 3/program (путь к установленному openoffice.org)</literal></para>
    </listitem>
  </itemizedlist>
  <para><emphasis role="bold">Установка и настройка OpenOffice.org в системах класса <application>UNIX</application></emphasis></para>
  <para>По опыту развертывания отчетов на серверах <application>ubuntu</application> для корректного запуска  программного ядра <application>openoffice.org</application> необходимо следующее:</para>
  <itemizedlist>
    <listitem>
      <para>Установить пакет <application>openoffice.org</application>, например, командой </para>
      <para><prompt>sudo aptitude install openoffice.org</prompt></para>
    </listitem>
    <listitem>
      <para>Установить свойство в файле <filename>local.app.properties</filename></para>
      <para><property>cuba.reporting.openoffice.path</property> = <literal>/usr/lib/openoffice/program (путь к установленному openoffice.org)</literal></para>
    </listitem>
    <listitem>
      <para>Если на сервере не установлена <application>X window system</application> (оконный интерфейс), то программное ядро  <application>openoffice.org</application> при старте будет выдавать ошибку вида <errorname>Caused by: java.awt.HeadlessException: No X11 DISPLAY variable was set, but this program performed an operation which requires it.</errorname> или же просто завершаться без сообщений об ошибках. Для устранения проблемы установите свойство в <filename>local.app.properties</filename>:</para>
      <para><property>cuba.reporting.displayDeviceUnavailable</property> = <literal>true</literal>, </para>
      <para>а также установите пакет <application>openoffice.org-headless</application>: </para>
      <para><prompt>sudo aptitude install openoffice.org-headless</prompt></para>
    </listitem>
    <listitem>
      <para>Для диагностики ошибок при старте <application>openoffice.org</application> можно выполнить следующую команду:</para>
      <para><prompt>strace -e trace=signal /usr/lib/openoffice/program/soffice.bin -headless -accept=&quot;socket,host=localhost,port=8100;urp&quot; -nofirststartwizard -nologo -nolockcheck</prompt></para>
    </listitem>
  </itemizedlist>
</chapter>
